theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Usage, y = Condition, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
plot1<-capUse[capUse$GOterm %in% c('glycolysis','TCA cycle','ETC','PPP','Ribosome'),]
ggplot(plot1, aes(x = Usage, y = Condition, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
annotate("text", x = capUse$GOterm, y = 35, label = capUse$GOterm) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Usage, y = Condition, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
annotate("text", x = capUse$GOterm, label = capUse$GOterm) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
annotate("text", x = capUse$GOterm, label = 'n=') +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
annotate("text", capUse$GOterm %in% c('glycolysis','TCA cycle','ETC','PPP','Ribosome'),label = 'n=') +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(label = GOterm)) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(label = Usage)) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(label = Condition)) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
capUse <- gather(capUse, 'Condition', 'Usage', 4:4)
capUse$GOterm <- factor(capUse$GOterm, levels=c('glycolysis','TCA cycle','ETC','PPP','Ribosome'))
capUse$Condition <- factor(capUse$Condition, levels=c('XP1'))
capUse <- read.delim('enzymeUsages.txt')
capUse <- capUse[,1:4]
capSum <- capUse[,4]
capUse <- capUse[!capSum==0,]
capUse[,4:4] <- capUse[,4:4]*100
GO <- read.delim('../../data/selectedAnnotation.txt', stringsAsFactors = F)
capUse <- capUse[capUse$protID %in% GO$Entry,]
idx <- match(capUse$protID, GO$Entry)
capUse$GOterm <- GO$system[idx]
colnames(capUse) <- gsub('capUse_','',colnames(capUse))
View(capUse)
View(capUse)
capUse <- capUse %>% mutate_if(is.numeric, round, digits = 3)
write_delim(capUse,'../../results/modelSimulation/capUsage.txt',delim = '\t')
capUse <- gather(capUse, 'Condition', 'Usage', 4:4)
capUse$GOterm <- factor(capUse$GOterm, levels=c('glycolysis','TCA cycle','ETC','PPP','Ribosome'))
capUse$Condition <- factor(capUse$Condition, levels=c('Xexp'))
plot1<-capUse[capUse$GOterm %in% c('glycolysis','TCA cycle','ETC','PPP','Ribosome'),]
ggplot(plot1)
ggplot(plot1, aes(x = Condition, y = Usage))
ggplot(plot1, geom_boxplot())
ggplot(plot1, aes(x = Condition, y = Usage), geom_boxplot())
>  ggplot(plot1, aes(x = Condition, y = Usage) + geom_boxplot())
ggplot(plot1, aes(x = Condition, y = Usage) + geom_boxplot())
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm) + geom_boxplot())
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(label = Condition)) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(label = protID)) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
plot1_annot <- plot1 %>%
count(Condition) %>%
mutate(
label = paste0("n = ", n),
drv = 4
)
View(plot1_annot)
plot1_annot <- plot1 %>%
count(GOterm) %>%
mutate(
label = paste0("n = ", n),
drv = 4
)
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, vjust = -0.5) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(y = Inf, label = label), data = plot1_annot, vjust = -0.5) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, vjust = -0.5) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, vjust = -0.5) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, vjust = -0.5) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, vjust = +2) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, hjust = 0.15, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, hjust = 1, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, hjust = 0.1, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
plot1_annot <- plot1 %>%
count(GOterm) %>%
mutate(
label = paste0("n = ", n)
)
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
,
plot1_annot <- plot1 %>%
count(GOterm) %>%
mutate(
label = paste0("n = ", n),
drv = 4
)
View(plot1_annot)
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(rows = vars(drv)) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(rows = vars(drv)) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(n, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(rows = vars(drv)) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(drv, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(rows = vars(drv)) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(rows = vars(drv)) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(GOterm, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
plot1_annot <- plot1 %>%
count(Condition) %>% count(GOterm)
mutate(
label = paste0("n = ", n),
drv = 4
)
plot1_annot <- plot1 %>%
count(Condition)
mutate(
label = paste0("n = ", n)
)
View(capUse)
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
plot1_annot <- plot1 %>%
count(Condition) %>%
mutate(
label = paste0("n = ", n)
)
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
capUse <- read.delim('enzymeUsages.txt')
capUse <- capUse[,1:4]
capSum <- capUse[,4]
capUse <- capUse[!capSum==0,]
capUse[,4:4] <- capUse[,4:4]*100
GO <- read.delim('../../data/selectedAnnotation.txt', stringsAsFactors = F)
capUse <- capUse[capUse$protID %in% GO$Entry,]
idx <- match(capUse$protID, GO$Entry)
capUse$GOterm <- GO$system[idx]
colnames(capUse) <- gsub('capUse_','',colnames(capUse))
capUse <- capUse %>% mutate_if(is.numeric, round, digits = 3)
write_delim(capUse,'../../results/modelSimulation/capUsage.txt',delim = '\t')
capUse <- gather(capUse, 'Condition', 'Usage', 4:4)
capUse$GOterm <- factor(capUse$GOterm, levels=c('glycolysis','TCA cycle','ETC','PPP','Ribosome'))
capUse$Condition <- factor(capUse$Condition, levels=c('Xexp'))
plot1<-capUse[capUse$GOterm %in% c('glycolysis','TCA cycle','ETC','PPP','Ribosome'),]
plot1_annot <- plot1 %>%
count(Condition) %>%
mutate(
label = paste0("n = ", n)
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
capUse <- read.delim('enzymeUsages.txt')
capUse <- capUse[,1:8]
capSum <- rowSums(capUse[,4:8])
capUse <- capUse[!capSum==0,]
capUse[,4:8] <- capUse[,4:8]*100
setwd("C:/Work/GitHub/overflow/results/enzymeUsage")
setwd("~/Documents/GitHub/overflow/results/enzymeUsage")
capUse <- read.delim('enzymeUsages.txt')
capUse <- capUse[,1:8]
capSum <- rowSums(capUse[,4:8])
capUse <- capUse[!capSum==0,]
capUse[,4:8] <- capUse[,4:8]*100
GO <- read.delim('../../data/selectedAnnotation.txt', stringsAsFactors = F)
capUse <- capUse[capUse$protID %in% GO$Entry,]
idx <- match(capUse$protID, GO$Entry)
capUse$GOterm <- GO$system[idx]
colnames(capUse) <- gsub('capUse_','',colnames(capUse))
capUse <- capUse %>% mutate_if(is.numeric, round, digits = 3)
capUse <- gather(capUse, 'Condition', 'Usage', 4:8)
capUse$GOterm <- factor(capUse$GOterm, levels=c('Glycolysis','TCA cycle','ETC','PP shunt','THF cycle','Ribosome'))
capUse$Condition <- factor(capUse$Condition, levels=c('CN4','CN22','CN38','CN75','hGR'))
plot1<-capUse[capUse$GOterm %in% c('Glycolysis','TCA cycle','ETC','Ribosome'),]
plot1_annot <- plot1 %>%
count(Condition) %>%
mutate(
label = paste0("n = ", n)
)
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787')) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
plot1_annot <- plot1 %>%
count(GOterm) %>%
mutate(
label = paste0("n = ", n)
)
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
#  geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
setwd("~/Documents/GitHub/ecRhtoGEM/results/modelSimulation")
capUse <- read.delim('enzymeUsages.txt')
capUse <- capUse[,1:4]
capSum <- capUse[,4]
capUse <- capUse[!capSum==0,]
capUse[,4:4] <- capUse[,4:4]*100
GO <- read.delim('../../data/selectedAnnotation.txt', stringsAsFactors = F)
capUse <- capUse[capUse$protID %in% GO$Entry,]
idx <- match(capUse$protID, GO$Entry)
capUse$GOterm <- GO$system[idx]
colnames(capUse) <- gsub('capUse_','',colnames(capUse))
capUse <- capUse %>% mutate_if(is.numeric, round, digits = 3)
write_delim(capUse,'../../results/modelSimulation/capUsage.txt',delim = '\t')
capUse <- gather(capUse, 'Condition', 'Usage', 4:4)
capUse$GOterm <- factor(capUse$GOterm, levels=c('glycolysis','TCA cycle','ETC','PPP','Ribosome'))
capUse$Condition <- factor(capUse$Condition, levels=c('Xexp'))
plot1<-capUse[capUse$GOterm %in% c('glycolysis','TCA cycle','ETC','PPP','Ribosome'),]
ggplot(plot1, aes(x = Condition, y = Usage, color=GOterm)) +
geom_boxplot(lwd = 0.35) +
#  geom_text(aes(Condition, y = Inf, label = label), data = plot1_annot, hjust = 0.05, vjust = +1) +
scale_color_manual(values=c('#CBBBA0','#1D1D1B','#1D71B8','#878787','#FF0000')) +
facet_grid(. ~ GOterm) +
labs(x = '', y = 'Capacity usage (%)') +
theme_classic() +
theme(axis.text.x=element_text(angle = 90, vjust = 0.5), text = element_text(size=7),
line = element_line(size=0.15), strip.background = element_blank(),
axis.line = element_line(size=0.15), legend.position='none')
ggsave("selectedGOtermUsage.pdf", width=10, height=4.5, units='cm')
